一种批量创建文档书签的方法和装置
技术领域
[0001] 本申请涉及文档处理领域，特别涉及一种批量创建文档书签的方法和装置。
背景技术
[0002] PDF文档，很大一部分是有Word或WPS等文档转换而来。转换过程中，如果不特意去设置，文档的目录是无法转换成PDF中书签的。
[0003] 例如，在药品的注册申报中，世界各国都普遍使用eCTD（电子化通用技术文档）作为申报材料，且格式要符合药监局及ICH（人用药品注册技术要求国际协调会）的要求。其中有一条便是：超过5页的文档必须要有与目录保持一致的书签。类似这种情况下，需要一种为文档创建书签的方法。
[0004] 目前，为PDF文档创建书签的方法一般为人工编辑，具体步骤为：1.用编辑器打开PDF（如阜新阅读器、Adobe Acrobat都有该功能）；2.找到文档目录中的第一个目录，记住其标题，把页面定位到目录的链接位置；3.新建书签，其标题为目录标题,此时书签位置和目录位置一致；4.如是重复操作2和3，直到所有目录都创建对应的书签。在文档目录较大时，按照常规做法，需要非常繁琐的操作，存在效率低下、出错率高的问题。
发明内容
[0005] 为了便于创建文档的书签，提高为文档创建书签时的效率、降低为文档创建书签时的出错率，本申请提供一种批量创建文档书签的方法和装置。
[0006] 在本申请的第一方面，提供了一种批量创建文档书签的方法,该方法包括：
载入要处置的文档；
从文档首页首行开始读取，逐页逐行遍历文档，查找目录信息；
根据目录信息在文档中创建书签；
保存文档，书签生效。
[0007] 进一步地，所述查找目录信息的方法包括:
一种自动获取目录的方法，能根据目录特征自动获取文档中已存在的目录，得到目录信息。
[0008] 进一步地，所述目录特征为由章节名称、连接符、页码组成的或类似的具有可解析结构的一系列字符串。
[0009] 进一步地，所述根据目录信息在文档中创建书签的方法包括：
读取每一行时判断其是否符合目录特征：如果符合目录特征，则表明该行为目录；如果不符合目录特征，继续判断临时书签表中的书签信息数量，若临时书签表中的书签信息数量为0，表明还尚未遍历到目录内容，若临时书签表中的书签信息数量>0，表明已经把目录遍历完毕，此时读取临时书签列表，创建成书签，并写入到文档中。
[0010] 进一步地，所述书签信息由标题、页码、页内坐标组成。
[0011] 进一步地，所述根据目录信息创建书签的方法包括：两种目录转书签的方法。
[0012] 进一步地，所述目录转书签的一种方法能够从目录信息中获取书签的标题及页码，根据页码与标题计算出所需的页内坐标，标题、页码、页内坐标构成所需的书签信息。
[0013] 相对地，所述目录转书签的另一种方法能够从目录的链接中提取到所需的页内坐标。
[0014] 在本申请的第二方面，提供了一种电子设备。该电子设备包括：存储器和处理器，所述存储器上存储有计算机程序，所述处理器执行所述程序时实现如本申请的第一方面中所述的方法。
[0015] 在本申请的第三方面，提供了一种计算机可读存储介质，其上存储有计算机程序，所述程序被处理器执行时实现如本申请的第一方面中所述的方法。
附图说明
[0016] 图1示出了根据本申请的方法批量创建文档书签的流程图。
实施例
[0017] （大概处理一个具体的PDF文档，虽然这里比较简单，但为了避免忽略一些细节，还是先与客户沟通、由客户来提供吧）
